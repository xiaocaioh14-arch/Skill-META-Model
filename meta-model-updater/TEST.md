# 🧪 元模型更新器 - 测试验证文档

> 用于验证 Skill 是否能正确工作

---

## 📋 测试前准备

### 检查清单

- [ ] 确认 `~/Project/SKILL_META_MODEL.md` 存在
- [ ] 确认 `~/Project/SKILLS_INDEX.md` 存在
- [ ] 确认 `~/Project/AGENTS.md` 存在
- [ ] 至少有一个 Skill 目录包含 `SKILL.md` 文件

---

## 🧪 测试用例

### 测试 1: 基础触发测试

**目标**: 验证 Skill 能被正常触发

**步骤**:
```
1. 在 Cowork 中说: "更新元模型"
2. 观察是否开始执行
3. 检查是否输出扫描结果
```

**预期结果**:
```
✅ 应该看到:
  - 扫描 ~/Project 目录
  - 找到最近修改的 SKILL.md
  或
  - 提示"未发现最近修改的 Skill"
```

**实际结果**: [ ]

---

### 测试 2: 指定路径测试

**目标**: 验证能指定具体的 Skill 路径

**步骤**:
```
1. 选择一个已存在的 Skill 路径
2. 在 Cowork 中说: "/update-meta-model ~/Project/[skill-name]/"
3. 观察执行过程
```

**预期结果**:
```
✅ 应该看到:
  - 跳过扫描步骤
  - 直接分析指定的 Skill
  - 执行 6 大维度检查清单
```

**实际结果**: [ ]

---

### 测试 3: 模式识别测试（全新模式）

**目标**: 验证能识别全新的设计模式

**步骤**:
```
1. 使用"组织文化分析"Skill（如果存在）
2. 触发: "/update-meta-model ~/Project/组织文化分析（会议纪要拆解）/"
3. 检查是否识别出"场景重构"模式
```

**预期结果**:
```
✅ 应该看到:
  - 分析维度: 内容分析维度
  - 识别模式: 基于事实的场景重构
  - 相似度 < 0.45 → novel
  - 通用性评分: 80+ 分
  - 添加为新模式
```

**实际结果**: [ ]

---

### 测试 4: 重复模式检测测试

**目标**: 验证能识别并拒绝重复模式

**步骤**:
```
1. 创建一个简单的测试 Skill:
   ~/Project/test-skill/SKILL.md
   (内容: 静默执行 + 双格式输出，与模式 1/3 相同)

2. 触发: "/update-meta-model ~/Project/test-skill/"
3. 检查去重逻辑是否生效
```

**预期结果**:
```
✅ 应该看到:
  - 分析完成
  - 与模式 1、3 对比
  - 相似度 > 0.85 → duplicate
  - 输出: "⚠️ 未发现新模式 (与现有模式重复)"
  - 不修改 SKILL_META_MODEL.md
```

**实际结果**: [ ]

---

### 测试 5: 元模型更新测试

**目标**: 验证能正确更新 SKILL_META_MODEL.md

**步骤**:
```
1. 备份当前的 SKILL_META_MODEL.md
2. 触发更新（使用有新模式的 Skill）
3. 对比文件变更
```

**预期结果**:
```
✅ 应该看到:
  - SKILL_META_MODEL.md 新增了一个"模式 N"章节
  - 章节结构符合标准格式:
    - 模式名称
    - 核心思想
    - 实现框架
    - 对比示例
    - 适用场景
    - 实现代码
  - 元数据更新（更新日期）
```

**验证命令**:
```bash
git diff SKILL_META_MODEL.md
```

**实际结果**: [ ]

---

### 测试 6: 索引同步测试

**目标**: 验证 SKILLS_INDEX.md 同步更新

**步骤**:
```
1. 备份当前的 SKILLS_INDEX.md
2. 使用新 Skill 触发更新
3. 检查索引是否新增条目
```

**预期结果**:
```
✅ 应该看到:
  - SKILLS_INDEX.md 新增 Skill 条目
  - 统计数字更新（总数 +1）
  - 新条目标记 🆕
  - 条目包含: 路径、名称、功能特性、触发方式
```

**验证命令**:
```bash
git diff SKILLS_INDEX.md
```

**实际结果**: [ ]

---

### 测试 7: 摘要输出测试

**目标**: 验证输出摘要的完整性和可读性

**步骤**:
```
1. 触发任意更新
2. 检查输出摘要的格式
```

**预期结果**:
```
✅ 摘要应该包含:
  - 标题: "✅ 元模型更新完成"
  - 本次更新:
    - 分析的 Skill 名称和路径
    - 新增/未新增模式的说明
    - 更新的文件列表
  - 新模式摘要（如果有）:
    - 核心思想
    - 适用场景
    - 核心代码
  - 下一步建议
  - 更新时间
```

**实际结果**: [ ]

---

### 测试 8: 边缘情况测试

**目标**: 验证错误处理的健壮性

#### 8.1 无 SKILL.md 文件

**步骤**:
```
触发: "/update-meta-model ~/Project/不存在的目录/"
```

**预期结果**:
```
⚠️ 应该优雅退出:
  - 提示: "未找到 SKILL.md 文件"
  - 不报错、不崩溃
```

**实际结果**: [ ]

---

#### 8.2 空的 SKILL.md

**步骤**:
```
1. 创建空文件: ~/Project/empty-skill/SKILL.md
2. 触发: "/update-meta-model ~/Project/empty-skill/"
```

**预期结果**:
```
⚠️ 应该输出:
  - 提示: "SKILL.md 内容为空或格式错误"
  - 未发现新模式
```

**实际结果**: [ ]

---

#### 8.3 24 小时内无修改

**步骤**:
```
1. 确保没有 Skill 在最近 24 小时内修改
2. 触发: "更新元模型"
```

**预期结果**:
```
ℹ️ 应该输出:
  - 扫描结果: 未发现最近修改的 Skill
  - 提示: 可以使用 /update-meta-model [path] 指定路径
  - 优雅退出
```

**实际结果**: [ ]

---

## 📊 测试结果汇总

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| 测试 1: 基础触发 | [ ] | |
| 测试 2: 指定路径 | [ ] | |
| 测试 3: 全新模式识别 | [ ] | |
| 测试 4: 重复模式检测 | [ ] | |
| 测试 5: 元模型更新 | [ ] | |
| 测试 6: 索引同步 | [ ] | |
| 测试 7: 摘要输出 | [ ] | |
| 测试 8.1: 无文件 | [ ] | |
| 测试 8.2: 空文件 | [ ] | |
| 测试 8.3: 无修改 | [ ] | |

**通过标准**: 至少 8/10 通过

---

## 🔧 调试技巧

### 如果测试失败

1. **检查文件路径**
   ```bash
   ls -la ~/Project/SKILL_META_MODEL.md
   ls -la ~/Project/SKILLS_INDEX.md
   ```

2. **检查 SKILL.md 格式**
   ```bash
   head -20 ~/Project/[skill-name]/SKILL.md
   ```

3. **查看详细执行日志**
   - 在 Cowork 中说: "详细模式执行更新元模型"

4. **手动验证去重逻辑**
   ```bash
   # 读取现有模式
   grep "### 模式" ~/Project/SKILL_META_MODEL.md

   # 对比相似度
   diff <(cat existing-pattern.txt) <(cat new-pattern.txt)
   ```

---

## 💡 测试建议

### 首次测试

建议按以下顺序执行：

```
1. 测试 1 (基础触发) → 验证 Skill 能运行
2. 测试 2 (指定路径) → 验证路径参数
3. 测试 8 (边缘情况) → 验证错误处理
4. 测试 4 (重复检测) → 验证去重逻辑
5. 测试 3 (模式识别) → 验证核心功能
6. 测试 5 & 6 (文件更新) → 验证完整流程
7. 测试 7 (摘要输出) → 验证用户体验
```

### 持续验证

每次修改 SKILL.md 后，运行：
- 测试 1, 3, 5, 6, 7

---

## 📝 测试记录

### 测试日期: [YYYY-MM-DD]

**测试环境**:
- 工具: Claude Cowork
- 路径: ~/Project/skill 元模型/meta-model-updater/
- 版本: v1.0

**测试结果**: [通过 X / 失败 Y / 总计 10]

**问题记录**:
1. [问题描述]
   - 影响: [严重/中等/轻微]
   - 解决方案: [描述]

2. [问题描述]
   - 影响: [严重/中等/轻微]
   - 解决方案: [描述]

**改进建议**:
- [ ] [建议 1]
- [ ] [建议 2]
- [ ] [建议 3]

---

## ✅ 验收标准

本 Skill 可以正式使用的条件：

- [ ] **基础功能** - 所有核心测试用例通过（测试 1-7）
- [ ] **健壮性** - 边缘情况不会导致崩溃（测试 8）
- [ ] **准确性** - 模式识别准确率 > 90%
- [ ] **用户体验** - 摘要输出清晰易读
- [ ] **文档完整** - SKILL.md, README.md, TEST.md 齐全

---

*使用此测试文档确保 Skill 质量，持续改进优化* 🧪
